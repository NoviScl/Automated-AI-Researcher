#!/bin/bash
wandb_name=8xh100dev_2gpu
timeout=2h

export WANDB_NAME=$wandb_name
export WANDB_PROJECT=nanogpt_ES_claude

if ! timeout $timeout uv run torchrun \
    --standalone \
    --nproc_per_node=2 \
    train.py \
    --batch_size 128; then
    echo "train.py failed with exit code $?. The script will continue."
fi

echo "run.sh has finished."